<!--
             _.-~-.
           7''  Q..\
        _7         (_
      _7  _/    _q.  /
    _7 . ___  /VVvv-'_                                            .
   7/ / /~- \_\\      '-._     .-'                      /       //
  ./ ( /-~-/||'=.__  '::. '-~'' {             ___   /  //     ./{
 V   V-~-~| ||   __''_   ':::.   ''~-~.___.-'' _/  // / {_   /  {  /
  VV/-~-~-|/ \ .'__'. '.    '::                     _ _ _        ''.
  / /~~~~||VVV/ /  \ )  \        _ __ ___   ___ ___(_) | | __ _   .::'
 / (~-~-~\\.-' /    \'   \::::. | '_ ` _ \ / _ \_  / | | |/ _` | :::'
/..\    /..\__/      '     '::: | | | | | | (_) / /| | | | (_| | ::'
vVVv    vVVv                 ': |_| |_| |_|\___/___|_|_|_|\__,_| ''

This is the custom Mozilla Login Experience, designed and built by Mozilla's IAM Project.

Version: 1.3.0
Changelog: https://github.com/mozilla-iam/auth0-custom-lock/blob/master/CHANGELOG.md

These are the variables we are using:

  Auth0-domain: {{{ auth0_domain }}}
  Client ID: {{{ client_id }}}
  LDAP connection name: {{{ LDAP_connection_name }}}
  Person API domain: {{{ person_api_domain }}}
  Google Tag Manager ID: {{{ GTM_ID }}}
  Logout URL: {{{ logout_url }}}
  Features:
   autologin: {{{ features.autologin }}}
   person_api_lookup: {{{ features.person_api_lookup }}}
   supportedLoginMethods: {{{ supportedLoginMethods }}}

The code is the result of a build process, please find the source code
on GitHub: https://github.com/mozilla-iam/auth0-custom-lock
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Mozilla Login</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
    /* Trigger NLX actions that should happen before user sees NLX */

    if ( window.location.href.indexOf( 'action=logout' ) >= 0  ) {
      // clear autologin method
      if ( window.localStorage ) {
        window.localStorage.removeItem( 'nlx-last-used-connection' );
      }
      // redirect to logout URL
      window.location.replace( '{{{ logout_url }}}' );
    }
    </script>
    <link href="../../dist/css/styles.css" type="text/css" inline />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600" rel="stylesheet">
  </head>
  <body data-decorator="load-ga display-rp-name">
    <!--
    <div class="banner">
      <p></p>
    </div>
    -->
    <div class="card">
      <a href="https://mozilla.org" class="logo" target="_blank"><img alt="Mozilla" src="../images/mozilla.svg" inline /></a>
      <noscript><p>This login form requires JavaScript to work, please enable it to log in.</p></noscript>
      <form data-decorator="init-auth handle-submit" method="post" action="/" lock-state="initial">
        <fieldset data-decorator="decide-screen">
          <legend class="rp-name"><span class="visually-hidden">Log in to </span><span id="rp-name-placeholder" class="rp-name__text"></span></legend>
          <div id="loading" class="loading" data-screen data-hidden aria-hidden inert>
            <p class="visually-hidden ">Loadingâ€¦</p>
            <img src="../images/loading.svg" class="loading__spinner" inline />
            <p role="alert" id="loading__status" class="loading__status"></p>
          </div>
          <div id="initial" data-screen data-hidden aria-hidden>
            <div class="form__input">
              <input type="email" name="username" id="field-email" autocomplete="username email" autofocus data-decorator="watch-contents" />
              <label for="field-email"><span>E-mail</span></label>
            </div>
            <input type="submit" class="button button--full-width" id="enter-initial" value="Enter" />
            <hr>
            <ul class="login-options list list--plain">
              <li data-optional-login-method="firefoxaccounts">
                <button class="button button--full-width button--social button--secondary" type="button" data-handler="authorise-firefoxaccounts">
                  <img inline  class="icon" src="../images/firefox.svg">
                  <span><span class="visually-hidden">Log in with </span>Firefox Accounts</span>
                </button>
              </li>
              <li data-optional-login-method="github">
                <button class="button button--full-width button--social button--secondary" type="button" data-handler="authorise-github">
                  <img inline class="icon" src="../images/github.svg">
                  <span><span class="visually-hidden">Log in with </span>GitHub</span>
                </button>
              </li>
              <li data-optional-login-method="google-oauth2">
                <button class="button button--full-width button--social button--secondary" type="button" data-handler="authorise-google">
                  <img inline  class="icon" src="../images/google.svg">
                  <span><span class="visually-hidden">Log in with </span>Google</span>
                </button>
            </ul>
            <hr>
            <div class="setting">
              <input type="checkbox" id="use-autologin" data-decorator="set-autologin-preference" checked>
              <label for="use-autologin"><span class="setting__toggle"></span> <span class="setting__enabled-text">Disable Auto-login</span><span class="setting__disabled-text">Enable Auto-login</span></label>
            </div>
          </div>
          <div id="ldap" data-screen data-hidden aria-hidden inert>
            <label for="field-password">LDAP password</label>
            <input type="password" id="field-password" autocomplete="current-password" name="password" data-decorator="submit-with-enter" data-continue-with="authorise-ldap-credentials"  />
            <input type="submit" class="button button--full-width" id="authorise-ldap-credentials" value="Enter"/>
            <hr>
            <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
          </div>
          <div id="non-ldap" data-screen data-hidden aria-hidden inert>
            <ul class="login-options list list--plain" data-optional-login-method="email">
              <li>
                <button class="button button--full-width button--secondary" type="button" data-handler="send-passwordless-link">Send me an email</button>
              </li>
            </ul>
            <a href="https://wiki.mozilla.org/IAM/Frequently_asked_questions#Q:_Why_do_you_support_email_login_.28.22passwordless.22.29_if_it.27s_less_safe_than_other_methods.3F" class="button button--text-only button--unpadded" target="_blank">Why an email?</a>
            <hr>
            <ul class="login-options list list--plain">
              <li data-optional-login-method="firefoxaccounts">
                <button class="button button--full-width button--social button--secondary" type="button" data-handler="authorise-firefoxaccounts">
                  <img inline  class="icon" src="../images/firefox.svg">
                  <span>Firefox Accounts</span>
                </button>
              </li>
              <li data-optional-login-method="github">
                <button class="button button--full-width button--social button--secondary" type="button" data-handler="authorise-github">
                  <img inline class="icon" src="../images/github.svg">
                  <span>GitHub</span>
                </button>
              </li>
              <li data-optional-login-method="google-oauth2">
                <button class="button button--full-width button--social button--secondary" type="button" data-handler="authorise-google">
                  <img inline  class="icon" src="../images/google.svg">
                  <span>Google</span>
                </button>
            </ul>
            <hr>
            <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
          </div>
          <div id="passwordless-success" data-screen data-hidden aria-hidden inert>
            <h2 class="card__heading card__heading--success"><img src="../images/envelope.svg" class="card__heading-icon" inline /> <span>Success</span></h2>
            <p>Email sent to <span id="passwordless-success-email-address"></span>, your login link will expire in 15 minutes.</p>
            <hr>
            <button id="back" type="button" class="button button--text-only card__back  button--unpadded" data-handler="go-to-initial-page">Need to send that to a different email?</button>
          </div>
          <div id="error-password" data-screen data-hidden aria-hidden inert>
            <h2 class="card__heading card__heading--error" id="error-message-ldap"><img src="../images/circled-x.svg" class="card__heading-icon" inline /> <span>Error</span></h2>
            <p>Please attempt again or contact the Help Desk for assistance.</p>
            <label for="field-password-try-2" class="visually-hidden">Password</label>
            <input type="password" name="password" id="field-password-try-2" autocomplete="current-password" placeholder="Password" data-decorator="submit-with-enter" data-continue-with="authorise-ldap-credentials-try-2" />
            <input type="submit" class="button button--full-width" id="authorise-ldap-credentials-try-2" value="Enter" />
            <hr>
            <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
          </div>
          <div id="error-passwordless" data-screen data-hidden aria-hidden inert>
            <h2 class="card__heading card__heading--error" id="error-message-passwordless"><img src="../images/circled-x.svg" class="card__heading-icon" inline /> <span>Error</span></h2>
            <p>We cannot send an email to this address</p>
            <button type="button" class="button button--text-only card__back  button--unpadded" data-handler="go-to-initial-page">Try again</button>
            <hr>
            <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
          </div>
          <div id="ldap-not-available" data-screen data-hidden aria-hidden inert>
            <h2 class="card__heading card__heading--error"><img src="../images/circled-x.svg" class="card__heading-icon" inline /> <span>Error</span></h2>
            <p>Unfortunately, this website does not offer login with Mozilla LDAP.</p>
            <hr>
            <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
          </div>
          <div id="ldap-required" data-screen data-hidden aria-hidden inert>
            <h2 class="card__heading card__heading--error"><img src="../images/circled-x.svg" class="card__heading-icon" inline /> <span>Error</span></h2>
            <p>Unfortunately, you can only login to this website using Mozilla LDAP.</p>
            <hr>
            <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
          </div>
          <div id="autologin-settings" data-screen data-hidden aria-hidden inert>
            <h2 class="card__heading card__heading--iconless">Auto-login settings</h2>
            <p>You are currently logged in as <strong>hidde@hiddedevries.nl</strong> using <strong>Github</strong>.</p>
            <div class="setting">
              <input type="checkbox" id="use-autologin-2" data-decorator="set-autologin-preference" checked>
              <label for="use-autologin-2" toggle-text=""><span class="setting__toggle"></span> <span class="setting__enabled-text">Disable Auto-login</span><span class="setting__disabled-text">Enable Auto-login</span></label>
            </div>
            <hr>
            <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
          </div>
        </fieldset>
      </form>
      <ul class="legal-links list list--plain">
        <li><a href="https://www.mozilla.org/en-US/about/legal/" target="_blank">Legal</a></li>
        <li><a href="https://www.mozilla.org/en-US/privacy/websites/" target="_blank">Privacy</a></li>
        <li><a href="https://discourse.mozilla.org/c/iam" target="_blank">Need help?</a></li>
      </ul>
    </div>
    <script src="../../dist/js/main.js" inline></script>
  </body>
</html>
